# 1. Determine and configure hardware settings

Should be able to determine and configure fundamental system hardware.

## Key knowledge Areas

* Enable and disable integrated peripherals.
* Differentiate between various types of mass storage devices.
* Determine hardware resources for devices.
* Tools and utilities to list various hardware information (e.g. `lsub`, lspci`, etc.).
* Tools and utilities to manipulate USB devices.
* Conceptual understanding of `sysfs`, `udev` and `dbus`.

## Partial list of used files, terms and utilities

* `/sys`
* `/proc`
* `/dev`
* `modprobe`
* `lsmod`
* `lspci`
* `lsusb`

## Must know hardware concepts

* __IRQ__ (_Interrupt Request_): Hardware signal sent to the processor that temporarily stops a running program and allows a special program, an _interrupt handler_, to run instead. Hardware interrupts are used to handle events such as receiving data from a modem/network card, key presses, or mouse movements.
  * `/proc/interrupts`
* __DMA__ (_Direct memory Access): Feature that allows certain hardware subsystems to access main system memory (RAM) independent of the central processing unit (CPU). CPU first inititates the transfer, then it does other operations while the transfer is in progress and it finally receives an _interrupt_ from the DMA controller (DMAC) when the operation is done.
  * `/proc/dma`
* __I/O Ports/Addresses__: Unique locations in memory reserved for communications between CPU and specific physical hardware devices.
  * `/proc/ioports`
* __coldplug/hotplug__: Devices that should be unplugged when system is off (cold) or on (hot).

## Linux file system & external devices

* __Sysfs__ (`/sys`): Pseudo file system that exports information about various kernel subsystems, hardware devices, and associated device drivers from the kernel's device model to user space through virutal files.
* __D-Bus__ (_Desktop Bus_): Software bus, _Inter Process Communication (IPC)_ and _Remote Procedure Call (RPC)_ mechanism that allows communication between multiple processes running concurrently on the same machine. 
* __udev__ (`/dev`): Userspace system that enables the OS administrator to register userspace handlers for events. The events received by _udev_'s daemon are mainly generated by the (Linux) kernel in response to physical events relating to peripheral devices. As such, _udev_'s main purpose is to act upon peripheral detection and hot-plugging, including actions that return control to the kernel. It manages device nodes in the `/dev` directory by adding, symlinking and renaming them. _udev_ replaces the functionality of both _hotplug_ and _hwdetect_.
  * e.g. Every time we connect a USB media device, files will be created to link the device with the file system, and multiple references too for example `cd /dev/disk && ls -l`.

## Get information about hardware

* `lspci`: Show information about PCI buses and connected devices.
  * `-v`/`-vv`: More verbose.
  * `-s`: Information about specific device.
* `lsusb`: Show information about buses and USB devices connected.
  * `-v`/`-vv`/`-s`
  * `-t`: Information as a tree and details about USB port.

## System modules

Modules are part of the kernel that we can activate/deactivate to add/remove functionalities. They are very coupled to drivers.

Those are files that end with the extension `.ko` that are stored at `/lib/modules/kernel_version`.

### Commands for system modules

* `lsmod`: Show modules loaded in the system.
* `modinfo`: Show information about a module.
* `insmod`: Load a `.ko` file to the system.
* `rmmod`: Remove a module from the system.
  * `-w`: Wait for it's not being used.
  * `-f`: Force removal.
* `modprobe`: Load or remove modules and resolve dependencies.
  * `-f`: Force load even if kernel version is mismatched.
  * `-r`: Remove module.
  * `-v`: Verbose.

If you are looking for an specific module: `lsmod | grep floppy`.